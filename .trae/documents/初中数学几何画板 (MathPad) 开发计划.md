# 初中数学几何画板 (MathPad) 开发计划

我们将从零构建一个基于 Web 的专业几何画板应用，专注于初中数学教学场景。

## 1. 技术架构选型
- **前端框架**: React + TypeScript (强类型保证数学计算的严谨性)
- **构建工具**: Vite
- **图形引擎**: HTML5 Canvas (配合 `react-konva` 库进行声明式绘图管理)
- **状态管理**: Zustand (管理几何对象、依赖关系和应用状态)
- **样式方案**: Tailwind CSS (快速构建现代化 UI)
- **数学库**: Math.js (辅助复杂计算) + 自研几何算法模块

## 2. 核心模块规划

### 2.1 几何内核引擎 (Geometry Kernel)
- **数据模型**: 定义 `GeoElement` 接口，支持 Point, Line (Segment/Ray/Line), Circle, Polygon, FunctionGraph。
- **依赖系统**: 实现观察者模式或依赖图，处理“父子关系”（如：中点依赖于线段，线段依赖于端点）。当父元素移动时，自动递归更新子元素。
- **计算模块**: 实现解析几何算法，包括交点计算、距离公式、点到直线距离、向量运算等。

### 2.2 交互系统 (Interaction System)
- **工具模式**: 选择(Select)、点(Point)、线(Line)、圆(Circle)、文本(Text)等状态机切换。
- **智能吸附 (Snapping)**: 鼠标移动时自动吸附到现有几何元素（端点、线上点、圆上点），确保几何构造的精确性。
- **拖拽更新**: 实时响应拖拽事件，触发依赖系统的重计算。

### 2.3 功能模块实现
- **基本作图**: 任意点、直线、射线、线段、圆、多边形。
- **尺规构造**: 中点、垂线、平行线、角平分线（通过几何约束实现）。
- **测量工具**: 动态测量长度、角度、面积，并创建随动文本标签。
- **函数图像**: 输入解析式（如 `y = 2x + 1`），自动采样并在坐标系中绘制。
- **轨迹与动画**: 记录关键点历史位置实现轨迹；提供参数变量控制实现动画。

### 2.4 课件与文件系统
- **序列化**: 将画板状态导出为 JSON 格式。
- **课件管理**: 保存、加载、清空画布。
- **演示模式**: 隐藏辅助线，仅展示核心图形。

## 3. 实施步骤

### Phase 1: 基础设施搭建
1. 初始化项目结构，配置 Tailwind 和基础组件。
2. 搭建 Canvas 舞台，配置坐标系网格（Grid）和缩放/平移功能。

### Phase 2: 核心绘图与交互
1. 实现 `Point` 和 `Line` 的绘制与拖拽。
2. 建立“依赖更新机制”，实现简单的“中点”功能验证架构。
3. 扩展至 `Circle` 和 `Polygon`。

### Phase 3: 高级构造与测量
1. 实现智能吸附系统（关键交互体验）。
2. 开发构造工具集：垂线、平行线、角平分线。
3. 开发测量工具集：距离、角度显示。

### Phase 4: 初中数学特色功能
1. 实现坐标系与函数图像绘制。
2. 开发“轨迹追踪”功能。
3. 制作全等/相似三角形验证工具。

### Phase 5: UI 完善与交付
1. 美化工具栏、属性面板和动画控制条。
2. 实现课件保存/加载逻辑。
3. **制作10个示范课件**（JSON格式）：
   - 三角形: 内角和、中位线、全等判定(SSS/SAS)、勾股定理。
   - 圆: 垂径定理、圆周角定理、切线长定理。
   - 函数: 一次函数性质、二次函数变换。
   - 综合: 动点轨迹问题。

## 4. 质量保证
- **单元测试**: 对核心几何算法（如交点坐标计算）进行 Jest 测试。
- **验证**: 确保所有构造满足 IEEE 754 精度要求，并处理浮点数误差（Epsilon 比较）。
