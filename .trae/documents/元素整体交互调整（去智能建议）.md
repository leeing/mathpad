## 你的要求（按“元素整体”执行）
- **元素整体概念**：矩形/线段/圆/椭圆/抛物线/双曲线等形状，只能作为“元素本体”被选择、拖拽、变换；不允许通过其内部点/线段去单独移动或变形。
- **仅当元素本身是点（独立点）时**，才允许单独移动。
- **移除智能建议**（不保留开关入口）。

## 现状问题（已定位）
- 矩形目前由 4 点 + 4 线拼装（不是独立元素），因此天然会出现对点/边的单独操作：[CanvasStage.tsx](file:///Users/qadmlee/cmblab/mathpad/src/components/CanvasStage.tsx#L415-L512)。
- 多数形状（线/圆/抛物线等）依赖 Point 元素做构造点，Point 在选择模式下可拖拽，导致“内部点可单独移动”。

## 改造方案（最小破坏 + 保留可编辑性）

## 1) 矩形改为真正的 RectangleElement（整体对象）
- 新增 `RectangleElement`（centerX/centerY、width/height、rotation、style、definition）并接入 `GeoElement` 联合类型。
- 新增渲染组件 `Rectangle.tsx`，在 `GeoLayer.tsx` 中分发渲染；矩形在 select 模式下支持：
  - 点击选中（进入属性面板）
  - 拖拽整体平移
  - 右键菜单（隐藏/删除/属性）
- 修改 rectangle 工具的创建逻辑：不再创建 4 点 4 线，而是直接创建 rectangle 元素。
- 兼容旧数据：导入旧 JSON 时，识别“矩形=4 点 4 线”模式并自动合并迁移为 rectangle 元素（同时删除旧零件），保证你说的整体概念一致。

## 2) 全局禁止“构造点/内部点”被单独移动（只保留独立点可动）
- 定义 **独立点**：PointElement 且“没有被任何非点元素依赖”。
- 在 `Point.tsx` 中实现策略：
  - 若是独立点：允许 select 模式下点击/拖拽。
  - 若被任何非点元素依赖（线、圆、椭圆、抛物线、双曲线、矩形等）：在 select 模式下 **不可点击、不可拖拽**（只显示，不参与交互），避免抢点击。
- 这样一来：线段端点、圆的中心/边点、椭圆焦点/椭圆上点、抛物线/双曲线构造点等，都不会再被“单独移动”。

## 3) 为避免“不能改尺寸”的问题：给形状提供整体参数编辑入口
- 由于端点/构造点被锁定，必须提供等价的整体编辑方式，保证 3 分钟效率：
  - 线段/直线：在属性面板里提供端点坐标（或长度+方向）输入，修改时内部更新对应点坐标。
  - 圆：在属性面板里提供中心坐标 + 半径输入，修改时内部更新。
  - 椭圆/抛物线/双曲线：继续复用现有参数面板（ConicPanel），并确保其构造点不会被单独移动。
  - 矩形：提供中心/宽高/旋转角（第一版至少中心+宽高）。

## 4) 变换工具改为“对元素整体生效”
- 重写 `TransformPanel` 的目标：基于选中的 **元素 id** 执行平移/旋转/缩放/对称；不再以“自由点集合”为入口。
- 对点元素：允许变换（因为它就是元素本体）。
- 对其他元素：变换通过更新元素本体字段或其内部参数（但不暴露内部点拖动）。

## 5) 彻底移除智能建议
- 删除 `SuggestionPanel.tsx` 与 `core/analyzer/suggestions.ts`。
- 移除 `viewStore.suggestionsEnabled` 及相关 toggle。
- 移除快捷键/右键菜单中与“建议”相关的入口。
- 移除 `App.tsx` 中的装配引用。

## 6) 验证
- 补充/更新单测：
  - “点锁定判定”与交互条件
  - rectangle 新元素的构造与基础变换
- 跑通 `npm run test` 与 `npm run build`。

我将按以上方案修改，最终效果是：除了独立点，任何形状的内部点都无法被单独拖动；矩形成为真正的整体元素；变换和编辑都以元素为单位；并移除智能建议全链路。